"0","create_gt_table <- function(data, plot_type, title, subtitle) {"
"0","  "
"0","  palette <- ifelse(plot_type == 'over', 'ggsci::green_material', 'ggsci::red_material')"
"0","  "
"0","  direction <- ifelse(plot_type == 'over', 1, -1)"
"0","  "
"0","  table <- data |> "
"0","    cbd_gt_logos(team, team) |> "
"0","    mutate(team = glue('{team} (#{barthag_rk})')) |> "
"0","    gt(id='table') |> "
"0","    gt_theme_538() |> "
"0","    fmt_markdown(team) |>"
"0","    cols_hide(columns = c(games, barthag_rk)) |> "
"0","    cols_align(columns = team, align = 'left') |> "
"0","    cols_align(columns = c(everything(), -team), 'center') |> "
"0","    fmt_number(columns = c(xW, difference), decimals = 2) |> "
"0","    gt_color_rows(difference, palette = palette, direction = direction) |> # set green or red palette"
"0","    cols_label(new_coach = 'Coach', wins = 'Actual', xW = 'Expected') |> "
"0","    cols_width(team ~ px(240), new_coach ~ px(140), wins:difference ~ px(95)) |> "
"0","    tab_spanner(columns = c(wins, xW, difference), label = 'Wins through December 21st') |> "
"0","    tab_style(locations = cells_body(columns = c(team, new_coach)), style = cell_text(weight = 'bold')) |> "
"0","    tab_header("
"0","      title = title,"
"0","      subtitle = subtitle"
"0","    ) |> "
"0","    tab_source_note(source_note = md('Data by Barttorvik and cbbdata<br>Viz. + Analysis by @andreweatherman')) |> "
"0","    # use custom css to adjust caption and heading lineheight and padding"
"0","    opt_css("
"0","      '"
"0","      #table .gt_sourcenote {"
"0","      line-height: 1.2"
"0","      }"
"0","      #table .gt_heading {"
"0","         padding-bottom: 0px;"
"0","         padding-top: 6px"
"0","        }"
"0","      #table .gt_subtitle {"
"0","         padding-top: 2px;"
"0","         padding-bottom: 6px;"
"0","        }"
"0","      '"
"0","    )"
"0","  "
"0","  return(table)"
"0","  "
"0","}"
